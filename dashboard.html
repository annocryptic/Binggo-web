<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BINGGO Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="dashboard.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Chart -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- TON Connect -->
<script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>

<script src="js/config.js"></script>

<script>
firebase.auth().onAuthStateChanged(user=>{
  if(!user) window.location.href="login.html";
});
</script>
</head>

<body>

<!-- ===== TOP NAVBAR ===== -->
<header class="topbar">

  <!-- LOGO LEFT -->
  <div class="nav-left">
    <img src="binggo-logo.png" class="logo">
  </div>

  <!-- NAV CENTER -->
  <nav class="nav-center">
    <button onclick="showPage('tasks')" class="active">Tasks</button>
    <button onclick="showPage('trading')">Trading</button>
    <button onclick="showPage('leaderboard')">Leaderboard</button>
    <button onclick="showPage('assets')">My Assets</button>
  </nav>

  <!-- PROFILE DROPDOWN -->
  <div class="nav-right dropdown">
    <img id="userAvatar" class="avatar" src="">
    <div class="dropdown-content">
      <button onclick="connectWallet()">Connect Wallet</button>
      <button onclick="disconnectWallet()">Disconnect</button>
      <button onclick="logout()">Logout</button>
    </div>
  </div>

</header>

<!-- ===== MAIN CONTENT ===== -->
<main class="container">

  <!-- TASKS -->
  <section id="tasks" class="page active">
    <h2>Social Tasks</h2>
    <div id="taskList"></div>
  </section>

  <!-- TRADING -->
  <section id="trading" class="page">
    <h2>Trading</h2>

    <div class="trade-grid">

      <div class="card">
        <h3>Market</h3>
        <div id="marketList"></div>
      </div>

      <div class="card">
        <h3>TON Price</h3>
        <canvas id="depthChart" height="220"></canvas>
      </div>

      <div class="card">
        <h3>Orderbook</h3>

        <div class="order-grid">
          <div>
            <h4>Buy</h4>
            <input id="buyPrice" placeholder="Price">
            <input id="buyAmount" placeholder="Amount">
            <button onclick="placeOrder('buy')">Buy</button>
          </div>

          <div>
            <h4>Sell</h4>
            <input id="sellPrice" placeholder="Price">
            <input id="sellAmount" placeholder="Amount">
            <button class="sell" onclick="placeOrder('sell')">Sell</button>
          </div>
        </div>

      </div>

    </div>
  </section>

  <!-- LEADERBOARD -->
  <section id="leaderboard" class="page">
    <h2>Leaderboard</h2>
    <div id="leaderboardList"></div>
  </section>

  <!-- MY ASSETS -->
  <section id="assets" class="page">
    <h2>My Assets</h2>
    <div class="card">
      <b>Wallet Address:</b>
      <p id="walletAddress">-</p>
      <b>TON Balance:</b>
      <p id="walletBalance">-</p>
    </div>
    <div class="card" id="tokenAssets">
      <h3>Tokens</h3>
      <div id="userTokens"></div>
    </div>
  </section>

</main>

<!-- ===== SCRIPTS ===== -->
<script src="js/dashboard.js"></script>
<script src="js/trading.js"></script>
<script src="js/orderbook.js"></script>
<script src="js/depthChart.js"></script>
<script src="js/tasks.js"></script>
<script src="js/leaderboard.js"></script>
<script src="js/wallet.js"></script>

<script>
firebase.auth().onAuthStateChanged(user=>{
  if(user?.photoURL){
    document.getElementById("userAvatar").src=user.photoURL;
  }
});
</script>

</body>
</html>